<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/core-slider/core-slider.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/core-slider/core-slider.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import uuid from 'uuid/v1';
import templateString from './core-slider.html';
import styleString from './core-slider.css';
import '../core-button/core-button';
import '../core-modal/core-modal';

// Create template element
const template = document.createElement('template');
template.innerHTML = templateString;

// Create style element
const style = document.createElement('style');
style.innerHTML = styleString;

/**
 * ImageSlider Class
 */
class coreSlider extends HTMLElement {
  /**
   * constructor
   */
  constructor() {
    super();
    // Set the default prop values
    this._index = 0;
    this._controlInitialized = false;

    // Create the shadow dom
    const shadowRoot = this.attachShadow({mode: 'open'});
    shadowRoot.appendChild(template.content.cloneNode(true));
    shadowRoot.appendChild(style.cloneNode(true));

    // Store slider link
    this._slider = this.shadowRoot.getElementById('slider');
  }

  /**
   * _handleLongText
   */
  _handleLongText() {
    const content = this._content.innerHTML;
    const title = this._title.innerHTML;
    const size = this.getAttribute('size');
    const theme = this.getAttribute('theme');
    const themeScale = theme === 'circle' ? 0.5 : 1;

    let needHide = false;
    let buttonSize;

    switch (size) {
      case 'small': {
        const limit = 30;
        buttonSize = 'tiny';
        if (content.length > limit * themeScale) {
          this._content.innerHTML = content.substring(0, limit) + '...';
          needHide = true;
        }
        break;
      }

      case 'medium': {
        const limit = 80;
        buttonSize = theme === 'circle' ? 'tiny' : 'xsmall';
        if (content.length > limit * themeScale) {
          this._content.innerHTML = content.substring(0, limit) + '...';
          needHide = true;
        }
        break;
      }

      case 'large': {
        const limit = 200;
        buttonSize = theme === 'circle' ? 'xsmall' : 'small';
        if (content.length > limit * themeScale) {
          this._content.innerHTML = content.substring(0, limit) + '...';
          needHide = true;
        }
        break;
      }

      default: break;
    }

    if (needHide) {
      this._hideContent(buttonSize, theme, title, content);
    }
  }

  /**
   * _hideContent
   * @param {*} buttonSize
   * @param {*} theme
   * @param {*} title
   * @param {*} content
   */
  _hideContent(buttonSize, theme, title, content) {
    // generate a modal name
    const id = uuid();

    // create a button linked to the modal
    const button = document.createElement('core-button');
    button.setAttribute('rounded', true);
    button.setAttribute('size', buttonSize);
    // button.setAttribute('theme', 'standard');
    button.setAttribute('color', 'secondary');
    button.setAttribute('modal', id);

    if (theme !== 'circle') {
      button.setAttribute('style', 'float: right; margin: 10px 20px;');
    } else {
      button.setAttribute('style', 'margin: 20px 20px;');
      this._content.style['align-items'] = 'center';
    }

    button.innerHTML = 'Read more';
    this._content.appendChild(button);

    // create a modal to show all description
    const modal = document.createElement('core-modal');
    modal.setAttribute('name', id);
    modal.innerHTML = `
      &lt;h1 slot="header">${title}&lt;/h1>
      &lt;p>${content}&lt;/p>
    `;
    document.body.appendChild(modal);
  }

  /**
   * observedAttributes getter
   */
  static get observedAttributes() {
    return [
      'time',
      'size',
      'theme',
      'shadow',
      'text',
      'control',
    ];
  }

  /**
   * size setter
   * @param {*} val
   */
  set size(val) {
    if (val) {
      this.setAttribute('size', val);
    } else {
      this.removeAttribute('size');
    }
  }

  /**
   * theme setter
   * @param {*} val
   */
  set theme(val) {
    if (val) {
      this.setAttribute('theme', val);
    } else {
      this.removeAttribute('theme');
    }
  }

  /**
   * shadow setter
   * @param {*} val
   */
  set shadow(val) {
    if (val === true) {
      this.setAttribute('shadow', '');
    } else {
      this.removeAttribute('shadow');
    }
  }

  /**
   * text setter
   * @param {*} val
   */
  set text(val) {
    if (val === true) {
      this.setAttribute('text', '');
    } else {
      this.removeAttribute('text');
    }
  }

  /**
   * control setter
   * @param {*} val
   */
  set control(val) {
    if (val === true) {
      this.setAttribute('control', '');
    } else {
      this.removeAttribute('control');
    }
  }

  /**
   * size getter
   */
  get size() {
    return this.getAttribute('size');
  }

  /**
   * theme getter
   */
  get theme() {
    return this.getAttribute('theme');
  }

  /**
   * shadow getter
   */
  get shadow() {
    return this.getAttribute('shadow') === '';
  }

  /**
   * text getter
   */
  get text() {
    return this.getAttribute('text') === '';
  }

  /**
   * control getter
   */
  get control() {
    return this.getAttribute('control') === '';
  }

  /**
   * connectedCallback
   */
  connectedCallback() {
    // Find all image children
    this._imageChildren = this.getElementsByTagName('img');
    this._imageChildCount = this._imageChildren.length;

    // change to setInterval to avoid recursion
    this._start(0);
  }

  /**
   * Initialize control
   */
  _initControl() {
    // Find all image children
    this._imageChildren = this.getElementsByTagName('img');
    this._imageChildCount = this._imageChildren.length;

    // Initialize menu
    this._initMenu();

    // Initialize arrows
    this._initArrows();
  }

  /**
   * _initMenu()
   */
  _initMenu() {
    let menuHTML = '';

    for (let i = 0; i &lt; this._imageChildCount; i ++) {
      menuHTML += `&lt;div index=${i} class="menu-item">&lt;/div>`;
    }

    const menu = document.createElement('div');
    menu.setAttribute('id', 'menu');
    menu.innerHTML = menuHTML;

    Array.from(menu.children).forEach((child) => {
      child.addEventListener('click', () => {
        this._start(child.getAttribute('index'));
      });
    });

    this._menuItems = Array.from(menu.children);
    this._menu = menu;
  }

  /**
   * _initArrows()
   */
  _initArrows() {
    const leftArrow = document.createElement('div');
    const rightArrow = document.createElement('div');

    leftArrow.setAttribute('id', 'left-arrow');
    leftArrow.classList.add('arrow');

    rightArrow.setAttribute('id', 'right-arrow');
    rightArrow.classList.add('arrow');

    leftArrow.addEventListener('click', () => {
      this.index -= 1;
      this._start(this.index);
    });

    rightArrow.addEventListener('click', () => {
      this.index += 1;
      this._start(this.index);
    });
    this._leftArrow = leftArrow;
    this._rightArrow = rightArrow;
  }

  /**
   * attributeChangedCallback
   * @param {*} attr
   * @param {*} oldV
   * @param {*} newV
   */
  attributeChangedCallback(attr, oldV, newV) {
    switch (attr) {
      case 'time': {
        this._slider.style.transitionDuration = newV;
        break;
      }

      case 'control': {
        this._setUpControl(oldV);
      }

      case 'text': {
        // Set up read more button;
        if (this.text &amp;&amp; this._title === undefined &amp;&amp; this._content === undefined) {
          this._title = this.querySelector('[slot="title"]');
          this._content = this.querySelector('[slot="content"]');

          if (this.text &amp;&amp; this._title !== null &amp;&amp; this._content !== null) {
            this._handleLongText();
          }
        }
      }

      default: break;
    }
  }

  /**
   * time getter
   */
  get time() {
    return this.getAttribute('time') || '2s';
  }

  /**
   * time setter
   * @param {*} val
   */
  set time(val) {
    if (val) {
      this.setAttribute('time', val);
    } else {
      this.setAttribute('time', '2s');
    }
  }

  /**
   * index getter
   */
  get index() {
    return this._index;
  }

  /**
   * index setter
   * @param {Number} v
   */
  set index(v) {
    this._index = v;
    // For looping
    if (this._index >= this._imageChildCount) this.index = 0;
    if (this._index &lt; 0) this.index = Number(this._imageChildCount) - 1;
  }

  /**
   * start from a specific picture
   * @param {Number} index
   */
  _start(index) {
    if (this._interval !== undefined) {
      clearInterval(this._interval);
    }

    this._reRender(index);

    this.index = index;
    this._interval = setInterval(this._tick.bind(this), parseFloat(this.time) * 1000);
  }

  /**
   * tick function
   */
  _tick() {
    this.index = Number(this.index) + 1;
    this._reRender(this.index);
  }

  /**
   * @param {Number} index
   */
  _reRender(index) {
    Array.from(this._imageChildren).forEach((child) => {
      child.classList.add('hide');
    });
    this._imageChildren[index].classList.remove('hide');

    if (this.control &amp;&amp; this._menuItems !== null) {
      this._menuItems.forEach((item) => {
        item.removeAttribute('selected', '');
      });
      this._menuItems[index].setAttribute('selected', '');
    }
  }

  /**
   * _setUpControl
   * @param {*} oldV
   */
  _setUpControl(oldV) {
    // Set up control
    if (!this._controlInitialized) {
      this._initControl();
      this._controlInitialized = false;
    }

    if (this.control) {
      this._slider.appendChild(this._menu);
      this._slider.appendChild(this._leftArrow);
      this._slider.appendChild(this._rightArrow);
    } else if (oldV === '') {
      this._slider.removeChild(this._slider.querySelector('#menu'));
      this._slider.removeChild(this._slider.querySelector('#left-arrow'));
      this._slider.removeChild(this._slider.querySelector('#right-arrow'));
    }
  }
}

if (!customElements.get('core-slier')) {
  customElements.define('core-slider', coreSlider);
}

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Popper.modifiers.html">modifiers</a></li></ul><h3>Classes</h3><ul><li><a href="aria.html">aria</a></li><li><a href="CoreButton.html">CoreButton</a></li><li><a href="CoreHello.html">CoreHello</a></li><li><a href="coreModal.html">coreModal</a></li><li><a href="coreSlider.html">coreSlider</a></li><li><a href="fecha.html">fecha</a></li><li><a href="module.html#.exports">exports</a></li><li><a href="Popper.html">Popper</a></li></ul><h3>Global</h3><ul><li><a href="global.html#_addLazyLoadListener">_addLazyLoadListener</a></li><li><a href="global.html#_getImageStyle">_getImageStyle</a></li><li><a href="global.html#_handleError">_handleError</a></li><li><a href="global.html#_handleLazyLoad">_handleLazyLoad</a></li><li><a href="global.html#_handleLoad">_handleLoad</a></li><li><a href="global.html#_loadImage">_loadImage</a></li><li><a href="global.html#_removeLazyLoadListener">_removeLazyLoadListener</a></li><li><a href="global.html#_updateTemplate">_updateTemplate</a></li><li><a href="global.html#alignCenter">alignCenter</a></li><li><a href="global.html#color">color</a></li><li><a href="global.html#connectedCallback">connectedCallback</a></li><li><a href="global.html#content">content</a></li><li><a href="global.html#attributeChangedCallback">attributeChangedCallback</a></li><li><a href="global.html#barStyle">barStyle</a></li><li><a href="global.html#circlePathStyle">circlePathStyle</a></li><li><a href="global.html#disconnectedCallback">disconnectedCallback</a></li><li><a href="global.html#error">error</a></li><li><a href="global.html#fit">fit</a></li><li><a href="global.html#hidden">hidden</a></li><li><a href="global.html#iconClass">iconClass</a></li><li><a href="global.html#imageStyle">imageStyle</a></li><li><a href="global.html#isDot">isDot</a></li><li><a href="global.html#lazy">lazy</a></li><li><a href="global.html#loading">loading</a></li><li><a href="global.html#max">max</a></li><li><a href="global.html#observedAttributes">observedAttributes</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#percentage">percentage</a></li><li><a href="global.html#perimeter">perimeter</a></li><li><a href="global.html#progressTextSize">progressTextSize</a></li><li><a href="global.html#relativeStrokeWidth">relativeStrokeWidth</a></li><li><a href="global.html#showText">showText</a></li><li><a href="global.html#src">src</a></li><li><a href="global.html#status">status</a></li><li><a href="global.html#stroke">stroke</a></li><li><a href="global.html#strokeWidth">strokeWidth</a></li><li><a href="global.html#textInside">textInside</a></li><li><a href="global.html#trackPath">trackPath</a></li><li><a href="global.html#type">type</a></li><li><a href="global.html#value">value</a></li><li><a href="global.html#width">width</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.1</a> on Mon Jun 03 2019 20:36:00 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
